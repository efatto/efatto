<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

<template id="l10n_it_central_journal.report_giornale">
    <t t-call="report.html_container">
        <t t-set="title" t-value="'Stampa libro giornale'"/>
        <t t-call="l10n_it_account.internal_layout">
            <div class="page">
                <t t-set="print_details" t-value="1"/>
                <t t-set="counter" t-value="start_row"/>
                <t t-set="save_move_id" t-value="0"/>
                <t t-set="tot_credit" t-value="progressive_credit"/>
                <t t-set="tot_debit" t-value="progressive_debit"/>
                <t t-set="class_new_move" t-value="''"/>
                <t t-set="first_page" t-value="True"/>
                <t t-set="num_rows" t-value="len(get_move(data['ids']))"/>
                <t t-set="page_rows" t-value="43"/>
                <t t-set="result_rows" t-value="get_move(data['ids'])"/>
                <t t-set="last_page" t-value="(num_rows/page_rows)-2"/>
                <t t-foreach="(num_rows/page_rows)-1" t-as="num_block">
                    <table style="width:100%;" cellspacing="0">
                        <style>
                            table {border: 0px;}
                            thead {background: #F5F5F5;}
                            .left_without_line_row {
                                font-size: 9px; color: black; font-family: "Courier New", Courier, monospace;
                                text-align:left; vertical-align:text-top; padding:1px 5px; width:40px; min-width:40px; max-width:40px;
                                height:22px; min-height:22px; max-height:22px;
                            }
                            .left_without_line_date {
                                font-size: 9px; color: black; font-family: "Courier New", Courier, monospace;
                                text-align:left; vertical-align:text-top; padding:1px 5px; width:60px; min-width:60px; max-width:60px;
                                height:22px; min-height:22px; max-height:22px;v
                            }
                            .left_without_line_code {
                                font-size: 9px; color: black; font-family: "Courier New", Courier, monospace;
                                text-align:left; vertical-align:text-top; padding:1px 5px; width:60px; min-width:60px; max-width:60px;
                                height:22px; min-height:22px; max-height:22px;
                            }
                            .left_without_line {
                                font-size: 9px; color: black; font-family: "Courier New", Courier, monospace;
                                text-align:left; vertical-align:text-top; padding:1px 5px; width:75px; min-width:75px; max-width:75px;
                                height:22px; min-height:22px; max-height:22px;
                            }
                            .left_without_line_account_name {
                                font-size: 9px; color: black; font-family: "Courier New", Courier, monospace;
                                text-align:left; vertical-align:text-top; padding:1px 5px; width:175px; min-width:175px; max-width:175px;
                                height:22px; min-height:22px; max-height:22px;
                            }
                            .left_without_line_name {
                                font-size: 9px; color: black; font-family: "Courier New", Courier, monospace;
                                text-align:left; vertical-align:text-top; padding:1px 5px; width:215px; min-width:215px; max-width:215px;
                                height:22px; min-height:22px; max-height:22px;
                            }
                            .right_without_line {
                                font-size: 9px; color: black; font-family: "Courier New", Courier, monospace;
                                text-align:right; vertical-align:text-top; padding:1px 5px; width:70px; min-width:70px; max-width:70px;
                                height:22px; min-height:22px; max-height:22px;
                            }
                            .new_move {
                                border-top: 1px solid #A1A1A1;
                            }
                        </style>
                        <thead>
                            <tr class="first_th_row">
                                <td colspan="9" style="padding:10px; font-weight: bold; font-size: 10px;" t-esc="'LIBRO GIORNALE - Periodo di stampa dal ' + formatLang(date_move_line_from, date=True) + ' al ' + formatLang(date_move_line_to, date=True)"/>
                            </tr>
                            <tr style="page-break-inside: avoid; border:1px solid #A1A1A1; ">
                                <th class="left_without_line_row">Row</th>
                                <th class="left_without_line_date">Date</th>
                                <th class="left_without_line">Ref</th>
                                <th class="left_without_line">Account move</th>
                                <th class="left_without_line_code">Account code</th>
                                <th class="left_without_line_account_name">Account name</th>
                                <th class="left_without_line_name">Name</th>
                                <th class="right_without_line">Debit</th>
                                <th class="right_without_line">Credit</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="page-break-inside: avoid;" >
                                <td class="left_without_line_row">
                                    <span t-if="first_page == True">
                                        <div style="page-break-inside: avoid" t-esc="counter"/>
                                    </span>
                                </td>
                                <td class="left_without_line_date"> </td>
                                <td class="left_without_line"> </td>
                                <td class="left_without_line"> </td>
                                <td class="left_without_line_code"> </td>
                                <td class="left_without_line_account_name"> </td>
                                <td class="left_without_line_name">
                                    <span t-if="first_page == True">Initial Balance</span>
                                    <span t-if="first_page == False">Progressive ==></span>
                                </td>
                                <td class="right_without_line">
                                    <div style="page-break-inside: avoid" t-esc="formatLang(tot_debit)" />
                                </td>
                                <td class="right_without_line">
                                    <div style="page-break-inside: avoid" t-esc="formatLang(tot_credit)" />
                                </td>
                            </tr>

                            <t t-foreach="result_rows[num_block*page_rows:(num_block+1)*page_rows]" t-as="line">
                                <t t-set="counter" t-value="counter + 1"/>
                                <t t-set="tot_credit" t-value="tot_credit + line.credit"/>
                                <t t-set="tot_debit" t-value="tot_debit + line.debit"/>
                                <t t-if="line.move_id.id != save_move_id">
                                   <t t-set="class_new_move" t-value="'new_move'"/>
                                </t>
                                <t t-if="line.move_id.id == save_move_id">
                                   <t t-set="class_new_move" t-value="''"/>
                                </t>
                                <tr style="page-break-inside: avoid;" t-att-class="class_new_move">
                                    <!-- Row -->
                                    <td class="left_without_line_row">
                                        <div style="page-break-inside: avoid"
                                        t-esc="counter"/>
                                    </td>
                                    <!-- Date -->
                                    <td class="left_without_line_date">
                                        <div style="page-break-inside: avoid"
                                        t-esc="formatLang(line.date, date=True)"/>
                                    </td>
                                    <!-- ref -->
                                    <td class="left_without_line">
                                        <div style="page-break-inside: avoid"
                                        t-esc="line.ref"/>
                                    </td>
                                    <!-- Account move -->
                                    <td class="left_without_line">
                                        <div style="page-break-inside: avoid"
                                        t-esc="line.move_id.name" />
                                    </td>
                                    <!-- Account code -->
                                    <td class="left_without_line_code">
                                        <div style="page-break-inside: avoid"
                                        t-esc="line.account_id.code" />
                                    </td>
                                    <!-- Account name -->
                                    <td class="left_without_line_account_name">
                                        <div style="page-break-inside: avoid"
                                        t-esc="line.account_id.name" />
                                    </td>
                                    <!-- Name -->
                                    <td class="left_without_line_name">
                                        <div style="page-break-inside: avoid"
                                        t-esc="line.name" />
                                    </td>
                                    <!-- Debit -->
                                    <td class="right_without_line">
                                        <div style="page-break-inside: avoid" t-esc="formatLang(line.debit)" />
                                    </td>
                                    <!-- Credit -->
                                    <td class="right_without_line">
                                        <div style="page-break-inside: avoid" t-esc="formatLang(line.credit)" />
                                    </td>
                                </tr>
                            <t t-set="save_move_id" t-value="line.move_id.id"/>
                            </t>
                            <t t-set="class_new_move" t-value="'new_move'"/>
                            <tr style="page-break-inside: avoid;" t-att-class="class_new_move">
                                <td class="left_without_line_row"> </td>
                                <td class="left_without_line_date"> </td>
                                <td class="left_without_line"> </td>
                                <td class="left_without_line"> </td>
                                <td class="left_without_line_code"> </td>
                                <td class="left_without_line_account_name"> </td>
                                <td class="left_without_line_name">
                                    <span t-if="last_page != num_block">Progressive ==></span>
                                    <span t-if="last_page == num_block">Final Balance</span>
                                </td>
                                <td class="right_without_line">
                                    <div style="page-break-inside: avoid"
                                    t-esc="formatLang(tot_debit)" />
                                </td>
                                <td class="right_without_line">
                                    <div style="page-break-inside: avoid"
                                    t-esc="formatLang(tot_credit)" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <t t-set="first_page" t-value="False"/>
                    <span t-if="last_page != num_block">
                        <div style="page-break-after: always"> </div>
                    </span>
                </t>
                <br/>
            </div>
            <t t-set="save_move_id" t-value="save_print_info(fiscalyear,date_move_line_to,counter,tot_debit,tot_credit)"/>
        </t>
    </t>
</template>

</data>
</openerp>

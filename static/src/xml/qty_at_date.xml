<?xml version="1.0" encoding="utf-8"?>
<templates>
<!--  Icon is red when:
      1. qty requested is greater than qty available and product is not mto and date scheduled is greater than date requested
      2. product is mto and date scheduled is greater than date requested-->
    <div t-extend="sale_stock.qtyAtDate">
        <t t-jquery="t[t-if^='widget.data.virtual_available_at_date']" t-operation="attributes">
            <attribute name="t-if">widget.data.virtual_available_at_date &lt; widget.data.qty_to_deliver and widget.data.scheduled_date &gt; widget.data.commitment_date</attribute>
        </t>
    </div>
    <div t-extend="sale_stock.QtyDetailPopOver">
        <t t-jquery="table > tbody > t > tr > td > small:first" t-operation="replace">
            <t t-if="data.virtual_available_at_date > 0">
                <small>Stock available date<span t-esc="data.delivery_date"/></small>
            </t>
            <t t-else="data.virtual_available_at_date = 0">
                <small>Stock unavailable</small>
            </t>
<!--            <div>-->
<!--            <small>TODO put delivery date if reordered?<b><span t-esc="data.customer_lead"/> days</b></small>-->
<!--            </div>-->
        </t>
    </div>
</templates>

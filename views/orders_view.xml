<?xml version="1.0" ?>
<odoo>

    <record id="view_sale_order_calendar" model="ir.ui.view">
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_sale_order_calendar"/>
        <field name="arch" type="xml">
            <calendar position="attributes">
                <attribute name="date_start">max_commitment_date</attribute>
                <attribute name="color">calendar_state</attribute>
                <attribute name="mode">month</attribute>
            </calendar>
            <field name="partner_id" position="after">
                <field name="color" invisible="1"/>
            </field>
        </field>
    </record>

    <record id="view_sale_order_kanban_color" model="ir.ui.view">
        <field name="name">sale.order.kanban.color</field>
        <field name="model">sale.order</field>
        <field name="arch" type="xml">
            <kanban class="oe_background_gray" default_group_by="delivery_week" quick_create="false">
                <field name="delivery_week"/>
                <field name="color"/>
                <field name="note"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click oe_kanban_color_#{kanban_getcolor(record.color.raw_value)}">
                        <div class="oe_kanban_content">
                            <h4><field name="name"/></h4>
                            <div style="margin-bottom: 5px"><field name="partner_id" widget="one2many"/></div>
                            <div>Commitment date: <field name="commitment_date"/></div>
                            <div>Max Commitment date: <field name="max_commitment_date"/></div>
                        </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="view_sale_order_search_color" model="ir.ui.view">
        <field name="name">sale.order.search.color</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_sales_order_filter"/>
        <field name="arch" type="xml">
            <filter name="my_sale_orders_filter" position="after">
                <separator/>
                <filter name="production_not_started" string="To Produce"
                      domain="[('calendar_state', 'in', ('to_evaluate','to_produce','to_receive','production_ready'))]"/>
                <filter name="production_started" string="In Production"
                      domain="[('calendar_state', '=', 'production_started')]"/>
                <filter name="production_done" string="Production Done"
                      domain="[('calendar_state', '=', 'production_done')]"/>
            </filter>
        </field>
    </record>

    <record id="act_sale_order_delivery" model="ir.actions.act_window">
        <field name="name">Orders to deliver</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">sale.order</field>
        <field name="view_type">form</field>
        <field name="view_id" ref="view_sale_order_kanban_color"/>
        <field name="view_mode">kanban,form,calendar</field>
        <field name="domain">[('state', 'not in', ('draft', 'cancel'))]</field>
        <field name="context">{'search_default_production_not_started': True}</field>
    </record>

    <menuitem action="act_sale_order_delivery"
        id="menu_act_sale_order_delivery" parent="sale.sale_order_menu"
        sequence="15" groups="sales_team.group_sale_salesman" />

</odoo>
